const colecta={arboles:[],patronCultivos:{hectareaRiego:0,hectareaTemporal:0,sinUso:0},superficieUrp:{riegoPrivada:0,riegoEjidal:0,riegoPrestada:0,riegoRentada:0,temporalPrivada:0,temporalEjidal:0,temporalPrestada:0,temporalRentada:0,usoPrivada:0,usoEjidal:0,usoPrestada:0,usoRentada:0},valorTierra:{hectareaPropiedadValorHA:0,hectareaEjidalesValorHA:0,hectareaPrestadasValorHA:0,hectareaSinUsoValorHA:0},actividadesProduccion:[],otrosCostos:[],costoAnualesEstablecimientoPlantacion:[],construcciones:[],vehiculos:[],implementos:[],equiposComunicacion:[],equipos:[],valorPlantacion:{anioEstablecido:"",vidaUtil:"",arbolesHA:0,costoArbol:0},repuestoHerramientas:[]};function colectaArbol(){document.querySelectorAll("#tablaVariedadArboles input").forEach(e=>{e.addEventListener("input",()=>{almacenarDatosColectaArboles(),dividirPorcentaje("#tablaVariedadArboles",1,2),sumarArboles()})})}function almacenarDatosColectaArboles(){const e=document.querySelector("#tablaVariedadArboles tbody"),t=e.rows.length;let o,a=[];for(let l=0;l<t;l++){let t={variedad:"",numArboles:0},r=Object.keys(t);for(let a=0;a<e.rows[l].cells.length;a++){const n=e.rows[l].cells[a].lastChild;if(n&&"INPUT"===n.tagName){const e="number"===n.type?""===n.value?0:parseFloat(n.value):n.value;o=r[a],t[o]="text"===n.type?e:parseFloat(e)}}a.push(t)}colecta.arboles=a,console.log(colecta)}function sumarArboles(){const e=document.querySelectorAll("#tablaVariedadArboles input[type='number']"),t=document.querySelector("#totalArboles");let o=0;e.forEach(e=>{const t=""===e.value?0:parseFloat(e.value);o+=parseFloat(t)}),t.textContent=o}function colectaPatronCultivos(){const e=document.querySelector("#tablaPatronCultivos");for(let t=0;t<e.children[1].children.length;t++){e.children[1].children[t].cells[1].children[0].addEventListener("input",()=>{const e=document.querySelector("#hectareaRiegoInput").value,t=document.querySelector("#hectareaTemporalInput").value,o=document.querySelector("#hectareaSinUsoInput").value;colecta.patronCultivos.hectareaRiego=parseFloat(e),colecta.patronCultivos.hectareaTemporal=parseFloat(t),colecta.patronCultivos.sinUso=parseFloat(o),mostrarSumatoriaPatronCultivos()})}}function mostrarSumatoriaPatronCultivos(){const e=document.querySelector("#superficieCultivo"),t=document.querySelector("#superficieCultivoPorcentaje"),o=document.querySelector("#hectareaRiegoPorcentaje"),a=document.querySelector("#hectareaTemporalPorcentaje"),l=document.querySelector("#hectareaSinUsoPorcentaje"),r=document.querySelector("#totalHectareas"),n=document.querySelector("#totalHectareasPorcentaje");let c=parseFloat(document.querySelector("#superficieCultivo").textContent),i=parseFloat(document.querySelector("#hectareaRiegoInput").value),s=parseFloat(document.querySelector("#hectareaTemporalInput").value),u=parseFloat(document.querySelector("#hectareaSinUsoInput").value),d=parseFloat(document.querySelector("#totalHectareas").textContent),m=0,p=0,b=0,C=0,v=0;c=i+s,d=c+u,m=c/d*100,p=i/c*100,b=s/c*100,C=u/d*100,v=m+C,e.textContent=c,t.textContent=m?m.toFixed(2):"",o.textContent=p?p.toFixed(2):"",a.textContent=b?b.toFixed(2):"",l.textContent=C?C.toFixed(2):"",r.textContent=d,n.textContent=v?v.toFixed(2):""}function colectaSuperficeUrp(){document.querySelectorAll(".inputSuperficeUrp").forEach(e=>{e.addEventListener("input",()=>{almacenarDatosSuperfice(),sumaAreaCultivadaSuperficeUrp(),sumarTotalHectareasFilas(),sumarTotalHA(),llenarValorTierra(),calcularValorTotalValorTierra(),sumatoriaTotalSuperficeValorTierra()})})}function almacenarDatosSuperfice(){const e=document.querySelectorAll(".inputSuperficeUrp"),{superficieUrp:t}=colecta,o=Object.keys(t);let a;for(let l=0;l<o.length;l++)a=o[l],t[a]=parseFloat(e[l].value)}function sumaAreaCultivadaSuperficeUrp(){const e=document.querySelectorAll(".inputSuperficeUrp"),t=document.querySelectorAll(".sumaAreaCultivada");for(let o=0;o<t.length;o++)0===o&&(t[0].textContent=parseFloat(e[0].value)+parseFloat(e[4].value)),1===o&&(t[1].textContent=parseFloat(e[1].value)+parseFloat(e[5].value)),2===o&&(t[2].textContent=parseFloat(e[2].value)+parseFloat(e[6].value)),3===o&&(t[3].textContent=parseFloat(e[3].value)+parseFloat(e[7].value))}function sumarTotalHectareasFilas(){const e=document.querySelector("#tablaSuperficeUrp").children[1];for(let t=0;t<e.rows.length;t++){let o=0;for(let a=1;a<e.rows[t].cells.length-1;a++)if(0===t){const l=e.rows[t].cells[a];o+=parseFloat(l.textContent)}else{const l=e.rows[t].cells[a].firstChild;o+=parseFloat(l.value)}const a=e.rows[t].cells.length-1;e.rows[t].cells[a].textContent=o}}function sumarTotalHA(){const e=document.querySelector("#tablaSuperficeUrp").children[1];for(let t=1;t<e.rows[1].cells.length;t++){let o=0;for(let a=1;a<e.rows.length;a++){if(t===e.rows[1].cells.length-1){const l=e.rows[a].cells[t];o+=parseFloat(l.textContent)}else{const l=e.rows[a].cells[t].firstChild;o+=parseFloat(l.value)}}document.querySelector("#tablaSuperficeUrp").children[2].firstElementChild.cells[t].textContent=o}}function llenarValorTierra(){const e=document.querySelector("#totalHa").textContent,t=document.querySelector("#totalHectareasPropiasPrivada").textContent,o=document.querySelector("#totalHectareasPropiasEjidales").textContent,a=document.querySelector("#totalHectareasNoPropiasPrestadas").textContent,l=document.querySelector("#totalHectareasNoPropiasRentadas").textContent,r=document.querySelector("#areaCultivadaSuperficie"),n=document.querySelector("#hectareaPropiedadSuperficie"),c=document.querySelector("#hectareaEjidalesSuperficie"),i=document.querySelector("#hectareaPrestadasSuperficie"),s=document.querySelector("#hectareaSinUsoSuperficie");r.textContent=e,n.textContent=t,c.textContent=o,i.textContent=a,s.textContent=l}function colectaValorTierra(){document.querySelectorAll("#tablaValorTierra input").forEach(e=>{e.addEventListener("input",()=>{almacenarDatosValorTierra(),calcularValorTotalValorTierra(),sumatoriaTotalSuperficeValorTierra()})})}function almacenarDatosValorTierra(){const e=document.querySelectorAll("#tablaValorTierra input"),{valorTierra:t}=colecta,o=Object.keys(t);let a;for(let l=0;l<o.length;l++)a=o[l],t[a]=parseFloat(e[l].value)}function calcularValorTotalValorTierra(){const e=parseFloat(document.querySelector("#hectareaPropiedadSuperficie").textContent),t=parseFloat(document.querySelector("#hectareaEjidalesSuperficie").textContent),o=parseFloat(document.querySelector("#hectareaPrestadasSuperficie").textContent),a=parseFloat(document.querySelector("#hectareaSinUsoSuperficie").textContent),l=parseFloat(document.querySelector("#hectareaPropiedadValorHA").value),r=parseFloat(document.querySelector("#hectareaEjidalesValorHA").value),n=parseFloat(document.querySelector("#hectareaPrestadasValorHA").value),c=parseFloat(document.querySelector("#hectareaSinUsoValorHA").value),i=document.querySelector("#hectareaPropiedadValorTotal"),s=document.querySelector("#hectareaEjidalesValorTotal"),u=document.querySelector("#hectareaPrestadasValorTotal"),d=document.querySelector("#hectareaSinUsoValorTotal");i.innerHTML="$ "+(e*l).toFixed(2),s.innerHTML="$ "+(t*r).toFixed(2),u.innerHTML="$ "+(o*n).toFixed(2),d.innerHTML="$ "+(a*c).toFixed(2)}function sumatoriaTotalSuperficeValorTierra(){const e=document.querySelector("#totalSuperficeHas"),t=document.querySelector("#totalSuperficeValorTotal"),o=parseFloat(document.querySelector("#hectareaPropiedadSuperficie").textContent),a=parseFloat(document.querySelector("#hectareaEjidalesSuperficie").textContent),l=parseFloat(document.querySelector("#hectareaPrestadasSuperficie").textContent),r=parseFloat(document.querySelector("#hectareaSinUsoSuperficie").textContent),n=document.querySelector("#hectareaPropiedadValorTotal").textContent,c=document.querySelector("#hectareaEjidalesValorTotal").textContent,i=document.querySelector("#hectareaPrestadasValorTotal").textContent,s=document.querySelector("#hectareaSinUsoValorTotal").textContent,u=parseFloat(n.split(" ")[1]),d=parseFloat(c.split(" ")[1]),m=parseFloat(i.split(" ")[1]),p=parseFloat(s.split(" ")[1]);e.textContent=o+a+l+r,t.textContent="$ "+(u+d+m+p)}function colectaValorPlantacion(){document.querySelectorAll("#tablaValorPlantacion input").forEach(e=>{e.addEventListener("input",()=>{almacenarDatosValorPlantacion(),calcularCostoPlantacion()})})}function calcularCostoPlantacion(){const e=document.querySelector("#tablaValorPlantacion #costoPlantacion"),t=parseFloat(document.querySelector("#tablaValorPlantacion #arbolesHa").value),o=parseFloat(document.querySelector("#tablaValorPlantacion #costoArbol").value),a=parseFloat(document.querySelector("#tablaValorTierra #totalSuperficeHas").textContent);e.textContent=convertirValorMonetario(t*o*a)}function almacenarDatosValorPlantacion(){const e=document.querySelectorAll("#tablaValorPlantacion input"),{valorPlantacion:t}=colecta;console.log(e);const o=Object.keys(t);let a;for(let l=0;l<o.length;l++)a=o[l],t[a]=isNaN(e[l].value)?parseFloat(e[l].value):0}function colectaActividadesProduccion(){document.querySelectorAll("#tablaActividadesProduccion input").forEach(e=>{e.addEventListener("input",()=>{almacenarDatosActividadesProduccion()})})}function almacenarDatosActividadesProduccion(){const e=document.querySelector("#tablaActividadesProduccion tbody"),t=e.rows.length;let o,a=[];for(let l=0;l<t;l++){let t={nombreActividadProduccion:"",precioUnitario:0,actual:0},r=Object.keys(t);for(let a=0;a<e.rows[l].cells.length;a++){const n=e.rows[l].cells[a].lastChild,c="number"===n.type?""===n.value?0:parseFloat(n.value):n.value;o=r[a],t[o]="text"===n.type?c:parseFloat(c)}a.push(t)}colecta.actividadesProduccion=a}function colectaOtrosCostos(){document.querySelectorAll("#tablaOtrosCostos input").forEach(e=>{e.addEventListener("input",()=>{almacenarDatosOtrosCostos()})})}function almacenarDatosOtrosCostos(){const e=document.querySelector("#tablaOtrosCostos tbody"),t=e.rows.length;let o,a=[];for(let l=0;l<t;l++){let t={nombreOtroCosto:"",precioUnitario:0,total:0},r=Object.keys(t);for(let a=0;a<e.rows[l].cells.length;a++){const n=e.rows[l].cells[a].lastChild,c="number"===n.type?""===n.value?0:parseFloat(n.value):n.value;o=r[a],t[o]="text"===n.type?c:parseFloat(c)}a.push(t)}colecta.otrosCostos=a}function colectaCostoAnualEstablecimientoPlantacion(){const e=document.querySelectorAll("#tablaCostoAnualEstablecimientoPlantacion input");colocarNumeroAnio(),e.forEach(e=>{e.addEventListener("input",()=>{almacenarDatosCostoAnualEstablecimientoPlantacion(),operacionesValorPlantacion()})})}function almacenarDatosCostoAnualEstablecimientoPlantacion(){const e=document.querySelector("#tablaCostoAnualEstablecimientoPlantacion tbody"),t=e.rows.length;let o,a=[];for(let l=0;l<t;l++){let t={numAnio:l+1,total:0},r=Object.keys(t);for(let a=0;a<e.rows[l].cells.length;a++){const n=e.rows[l].cells[a].lastChild,c="number"===n.type?""===n.value?0:parseFloat(n.value):n.value;o=r[a],t[o]="text"===n.type?c:parseFloat(c)}a.push(t)}colecta.costoAnualesEstablecimientoPlantacion=a}function colocarNumeroAnio(){const e=document.querySelector("#tablaCostoAnualEstablecimientoPlantacion tbody"),t=e.rows.length;for(let o=0;o<t;o++){e.rows[o].cells[0].firstChild.value="Año "+(o+1)}}function operacionesValorPlantacion(){const e=document.querySelectorAll(".costoAnual"),t=document.querySelector("#tablaTotalActividadesProduccion #costoTotalEst"),o=document.querySelector("#tablaTotalActividadesProduccion #depreciacionAnual"),a=document.querySelector("#tablaTotalActividadesProduccion #depreciacionAnualHa"),l=document.querySelector("#tablaValorPlantacion #vidaUtil"),r=""===l.value?0:parseFloat(l.value),n=document.querySelector("#tablaValorTierra #totalSuperficeHas").textContent,c=parseFloat(n);let i=0;e.forEach(e=>{const o=""===e.value?0:parseFloat(e.value);i+=o,t.textContent=convertirValorMonetario(i)});const s=extraerCaracteresNumber(t.textContent);depreciacionAnualTotalValor=s/r,depreciacionAnualTotalValor=isFinite(depreciacionAnualTotalValor)?depreciacionAnualTotalValor:0,o.textContent=convertirValorMonetario(depreciacionAnualTotalValor),depreciacionAnualHasTotalValor=depreciacionAnualTotalValor/c,depreciacionAnualHasTotalValor=isFinite(depreciacionAnualHasTotalValor)?depreciacionAnualHasTotalValor:0,a.textContent=convertirValorMonetario(depreciacionAnualHasTotalValor)}function almacenarDatosConstrucciones(){const e=document.querySelector("#tablaContrucciones").children[1],t={},{construcciones:o}=colecta;for(let a=0;a<e.rows.length;a++){for(let o=0;o<e.rows[a].cells.length-1;o++)if(o<=4){const l=e.rows[a].cells[o].firstChild;l.addEventListener("input",()=>{llenarObjeto(l,o,t),calcularOperacionesActivosFijos("#tablaContrucciones"),console.log(colecta)})}else{const l=e.rows[a].cells[o].children[1];l.addEventListener("input",()=>{llenarObjetoChildren(l,o,t),calcularOperacionesActivosFijos("#tablaContrucciones"),console.log(colecta)})}colecta.construcciones=[...o,t]}}function almacenarDatosVehiculos(){const e=document.querySelector("#tablaVehiculos").children[1],t={},{vehiculos:o}=colecta;for(let a=0;a<e.rows.length;a++){for(let o=0;o<e.rows[a].cells.length-1;o++)if(o<=4){const l=e.rows[a].cells[o].firstChild;l.addEventListener("input",()=>{llenarObjeto(l,o,t),calcularOperacionesActivosFijos("#tablaVehiculos"),console.log(colecta)})}else{const l=e.rows[a].cells[o].children[1];l.addEventListener("input",()=>{llenarObjetoChildren(l,o,t),calcularOperacionesActivosFijos("#tablaVehiculos")})}colecta.vehiculos=[...o,t]}}function almacenarDatosImplementos(){const e=document.querySelector("#tablaImplementos").children[1],t={},{implementos:o}=colecta;for(let a=0;a<e.rows.length;a++){for(let o=0;o<e.rows[a].cells.length-1;o++)if(o<=4){const l=e.rows[a].cells[o].firstChild;l.addEventListener("input",()=>{llenarObjeto(l,o,t),calcularOperacionesActivosFijos("#tablaImplementos"),console.log(colecta)})}else{const l=e.rows[a].cells[o].children[1];l.addEventListener("input",()=>{llenarObjetoChildren(l,o,t),calcularOperacionesActivosFijos("#tablaImplementos")})}colecta.implementos=[...o,t]}}function almacenarDatosEquipoComunicacion(){const e=document.querySelector("#tablaEquiposComunicacion").children[1],t={},{equiposComunicacion:o}=colecta;for(let a=0;a<e.rows.length;a++){for(let o=0;o<e.rows[a].cells.length-1;o++)if(o<=4){const l=e.rows[a].cells[o].firstChild;l.addEventListener("input",()=>{llenarObjeto(l,o,t),calcularOperacionesActivosFijos("#tablaEquiposComunicacion"),console.log(colecta)})}else{const l=e.rows[a].cells[o].children[1];l.addEventListener("input",()=>{llenarObjetoChildren(l,o,t),calcularOperacionesActivosFijos("#tablaEquiposComunicacion")})}colecta.equiposComunicacion=[...o,t]}}function almacenarDatosEquipo(){const e=document.querySelector("#tablaEquipos").children[1],t={},{equipos:o}=colecta;for(let a=0;a<e.rows.length;a++){for(let o=0;o<e.rows[a].cells.length-1;o++)if(o<=4){const l=e.rows[a].cells[o].firstChild;l.addEventListener("input",()=>{llenarObjeto(l,o,t),calcularOperacionesActivosFijos("#tablaEquipos"),console.log(colecta)})}else{const l=e.rows[a].cells[o].children[1];l.addEventListener("input",()=>{llenarObjetoChildren(l,o,t),calcularOperacionesActivosFijos("#tablaEquipos")})}colecta.equipos=[...o,t]}}function calcularOperacionesActivosFijos(e){document.querySelectorAll(e+" .etiqueta input[type='number']").forEach(t=>{t.addEventListener("input",()=>{operacionesOtrosActivosFijos(e)})})}function operacionesOtrosActivosFijos(e){sumaValorActualMercado(e),sumaValorRecuperacion(e),depreciacionAnual(e),sumadepreciacionAnual(e),totalValorActualMercado(),totalValorRecuperacion(),totalValorDepreciacionAnual()}function totalValorDepreciacionAnual(){let e=document.querySelector("#tablaTotales #totalDepreciacionAnual"),t=isNaN(document.querySelector("#tablaContrucciones #totalValorRecuperacion").textContent)?extraerCaracteresNumber(document.querySelector("#tablaContrucciones #totalValorDepreciacionAnual").textContent):0,o=isNaN(document.querySelector("#tablaVehiculos #totalValorDepreciacionAnual").textContent)?extraerCaracteresNumber(document.querySelector("#tablaVehiculos #totalValorDepreciacionAnual").textContent):0,a=isNaN(document.querySelector("#tablaImplementos #totalValorDepreciacionAnual").textContent)?extraerCaracteresNumber(document.querySelector("#tablaImplementos #totalValorDepreciacionAnual").textContent):0,l=isNaN(document.querySelector("#tablaEquiposComunicacion #totalValorDepreciacionAnual").textContent)?extraerCaracteresNumber(document.querySelector("#tablaEquiposComunicacion #totalValorDepreciacionAnual").textContent):0,r=isNaN(document.querySelector("#tablaEquipos #totalValorDepreciacionAnual").textContent)?extraerCaracteresNumber(document.querySelector("#tablaEquipos #totalValorDepreciacionAnual").textContent):0;total=t+o+a+l+r,e.textContent=convertirValorMonetario(total)}function totalValorRecuperacion(){let e=document.querySelector("#tablaTotales #totalValorRecuperacion"),t=isNaN(document.querySelector("#tablaContrucciones #totalValorRecuperacion").textContent)?extraerCaracteresNumber(document.querySelector("#tablaContrucciones #totalValorRecuperacion").textContent):0,o=isNaN(document.querySelector("#tablaVehiculos #totalValorRecuperacion").textContent)?extraerCaracteresNumber(document.querySelector("#tablaVehiculos #totalValorRecuperacion").textContent):0,a=isNaN(document.querySelector("#tablaImplementos #totalValorRecuperacion").textContent)?extraerCaracteresNumber(document.querySelector("#tablaImplementos #totalValorRecuperacion").textContent):0,l=isNaN(document.querySelector("#tablaEquiposComunicacion #totalValorRecuperacion").textContent)?extraerCaracteresNumber(document.querySelector("#tablaEquiposComunicacion #totalValorRecuperacion").textContent):0,r=isNaN(document.querySelector("#tablaEquipos #totalValorRecuperacion").textContent)?extraerCaracteresNumber(document.querySelector("#tablaEquipos #totalValorRecuperacion").textContent):0;total=t+o+a+l+r,e.textContent=convertirValorMonetario(total)}function totalValorActualMercado(){let e=document.querySelector("#tablaTotales #totalValorActualMercado"),t=isNaN(document.querySelector("#tablaContrucciones #totalValorActualMercado").textContent)?extraerCaracteresNumber(document.querySelector("#tablaContrucciones #totalValorActualMercado").textContent):0,o=isNaN(document.querySelector("#tablaVehiculos #totalValorActualMercado").textContent)?extraerCaracteresNumber(document.querySelector("#tablaVehiculos #totalValorActualMercado").textContent):0,a=isNaN(document.querySelector("#tablaImplementos #totalValorActualMercado").textContent)?extraerCaracteresNumber(document.querySelector("#tablaImplementos #totalValorActualMercado").textContent):0,l=isNaN(document.querySelector("#tablaEquiposComunicacion #totalValorActualMercado").textContent)?extraerCaracteresNumber(document.querySelector("#tablaEquiposComunicacion #totalValorActualMercado").textContent):0,r=isNaN(document.querySelector("#tablaEquipos #totalValorActualMercado").textContent)?extraerCaracteresNumber(document.querySelector("#tablaEquipos #totalValorActualMercado").textContent):0;total=t+o+a+l+r,e.textContent=convertirValorMonetario(total)}function sumadepreciacionAnual(e){const t=document.querySelector(e).children[1],o=document.querySelector(e+" #totalValorDepreciacionAnual");let a=0;for(let e=0;e<t.rows.length;e++)depreciacionAnualRubro=t.rows[e].cells[7].textContent,valorFloat=extraerCaracteresNumber(depreciacionAnualRubro),a+=valorFloat;o.textContent=formatter.format(a)}function depreciacionAnual(e){const t=document.querySelector(e).children[1];for(let e=0;e<t.rows.length;e++)celdaFinal=t.rows[e].cells[7],depreciacionPorcentaje=parseFloat(t.rows[e].cells[4].firstChild.value),porcenaje=.01*depreciacionPorcentaje,valorActualMercado=parseFloat(t.rows[e].cells[5].children[1].value),valorRecuperacion=parseFloat(t.rows[e].cells[6].children[1].value),depreciacionAnualRubro=parseFloat((valorActualMercado-valorRecuperacion)*porcenaje),celdaFinal.textContent=formatter.format(depreciacionAnualRubro)}function sumaValorRecuperacion(e){const t=document.querySelector(e+" #totalValorRecuperacion"),o=document.querySelectorAll(e+" .valorRecuperacion");let a=0;o.forEach(e=>{a+=parseFloat(e.value)}),t.innerHTML=formatter.format(a)}function sumaValorActualMercado(e){const t=document.querySelector(e+" #totalValorActualMercado"),o=document.querySelectorAll(e+" .valorActualMercado");let a=0;o.forEach(e=>{a+=parseFloat(e.value)}),t.innerHTML=formatter.format(a)}function llenarObjeto(e,t,o){0===t&&(o.nombre=e.value),1===t&&(o.anioConstruccionAdquisicion=parseInt(e.value)),2===t&&(o.modelo=parseInt(e.value)),3===t&&(o.anioVidaUtil=parseInt(e.value)),4===t&&(o.depreciacionAnual=parseFloat(e.value))}function llenarObjetoChildren(e,t,o){5===t&&(o.valorActualMercado=parseFloat(e.value)),6===t&&(o.valorRecuperacion=parseFloat(e.value))}function colectaRepuestoHerramientas(){document.querySelectorAll("#tablaRepuestoHerramientas input").forEach(e=>{e.addEventListener("input",()=>{almacenarDatosRepuestoHerramientas(),costoRepuestoHerramientas(),costoDepreciacionAnual()})})}function costoDepreciacionAnual(){const e=document.querySelector("#tablaRepuestoHerramientas tbody");for(let t=0;t<e.rows.length;t++){const o=extraerCaracteresNumber(e.rows[t].cells[3].textContent),a=e.rows[t].cells[4].lastChild,l=""===a.value?0:parseFloat(a.value),r=e.rows[t].cells[5].lastChild;let n=(o-o*(""===r.value?0:parseFloat(r.value)))/l*12;n=isFinite(n)?n:0,e.rows[t].cells[6].textContent=convertirValorMonetario(n)}}function costoRepuestoHerramientas(){const e=document.querySelector("#tablaRepuestoHerramientas tbody");for(let t=0;t<e.rows.length;t++){const o=e.rows[t].cells[1].lastChild,a=""===o.value?0:parseFloat(o.value),l=e.rows[t].cells[2].lastChild,r=a*(""===l.value?0:parseFloat(l.value));e.rows[t].cells[3].textContent=convertirValorMonetario(r)}}function almacenarDatosRepuestoHerramientas(){const e=document.querySelector("#tablaRepuestoHerramientas tbody"),t=e.rows.length;let o,a=[];for(let l=0;l<t;l++){let t={nombreHerramienta:"",cantidadHectarea:0,precioUnitario:0,vidaUtil:0,valorRepocicion:0},r=Object.keys(t);for(let a=0;a<r.length;a++){const n=e.rows[l].cells[a].lastChild;if(n&&"INPUT"===n.tagName){const e="number"===n.type?""===n.value?0:parseFloat(n.value):n.value;o=r[a],t[o]="text"===n.type?e:parseFloat(e)}}a.push(t)}colecta.repuestoHerramientas=a,console.log(colecta.repuestoHerramientas)}function sumarColumnaInputs(e,t){const o=document.querySelector(e+" tbody");let a=0;for(let e=0;e<o.rows.length;e++){const l=o.rows[e].cells[t].firstChild;a+=""===l.value?0:parseFloat(l.value)}return a}function dividirPorcentaje(e,t,o){const a=document.querySelector(e+" tbody");for(let l=0;l<a.rows.length;l++)for(let r=o;r<a.rows[l].cells.length;r++){const n=sumarColumnaInputs(e,t),c=a.rows[l].cells[r-1].firstChild,i=(""===c.value?0:parseFloat(c.value))/n*100,s=isNaN(i)?0:i.toFixed(2);a.rows[l].cells[o].innerHTML=`<span>${s}%</span>`}}document.addEventListener("DOMContentLoaded",()=>{colectaArbol(),colectaPatronCultivos(),mostrarSumatoriaPatronCultivos(),colectaSuperficeUrp(),almacenarDatosSuperfice(),sumaAreaCultivadaSuperficeUrp(),sumarTotalHectareasFilas(),sumarTotalHA(),llenarValorTierra(),colectaValorTierra(),calcularValorTotalValorTierra(),sumatoriaTotalSuperficeValorTierra(),colectaValorPlantacion(),colectaActividadesProduccion(),almacenarDatosActividadesProduccion(),colectaOtrosCostos(),almacenarDatosOtrosCostos(),colectaCostoAnualEstablecimientoPlantacion(),almacenarDatosCostoAnualEstablecimientoPlantacion(),almacenarDatosConstrucciones(),almacenarDatosVehiculos(),almacenarDatosImplementos(),almacenarDatosEquipoComunicacion(),almacenarDatosEquipo(),colectaRepuestoHerramientas()});const botonAgregarFilaVariedadArboles=document.querySelector("#nuevaFilaVariedad");function filaVariedadArboles(){const e=document.querySelector("#tablaVariedadArboles").children[1],t=document.createElement("TR"),o=document.createElement("TD"),a=document.createElement("TD"),l=document.createElement("TD"),r=document.createElement("INPUT"),n=document.createElement("INPUT");r.setAttribute("type","text"),r.setAttribute("required",""),n.setAttribute("type","number"),n.setAttribute("required",""),l.classList.add("total"),o.appendChild(r),a.appendChild(n),t.appendChild(o),t.appendChild(a),t.appendChild(l),e.appendChild(t),colectaArbol()}botonAgregarFilaVariedadArboles.addEventListener("click",()=>{filaVariedadArboles()});const botonEliminarFilaVariedad=document.querySelector("#eliminarFilaVariedad");botonEliminarFilaVariedad.addEventListener("click",()=>{eliminarUltimaFila("#tablaVariedadArboles",colecta.arboles,sumarArboles)});const botonNuevaFilaActividadesProduccion=document.querySelector("#nuevaFilaActividadesProduccion"),botonNuevaFilaOtosCostos=document.querySelector("#nuevaFilaOtosCostos");function filaActividadesProduccion(e,t){const o=document.querySelector(e).children[1],a=document.createElement("TR"),l=document.createElement("TD"),r=document.createElement("TD"),n=document.createElement("TD"),c=document.createElement("INPUT"),i=document.createElement("INPUT"),s=document.createElement("INPUT");r.classList.add("etiqueta"),n.classList.add("etiqueta"),c.setAttribute("type","text"),c.setAttribute("placeholder","Escribe el nombre"),c.setAttribute("required",""),i.setAttribute("type","number"),s.setAttribute("type","number"),l.appendChild(c),r.innerHTML+="<span>$</span>",r.appendChild(i),n.innerHTML+="<span>$</span>",n.appendChild(s),a.appendChild(l),a.appendChild(r),a.appendChild(n),o.appendChild(a),t()}botonNuevaFilaActividadesProduccion.addEventListener("click",()=>{filaActividadesProduccion("#tablaActividadesProduccion",colectaActividadesProduccion)}),botonNuevaFilaOtosCostos.addEventListener("click",()=>{filaActividadesProduccion("#tablaOtrosCostos",colectaOtrosCostos)});const botonEliminarFilaActividadesProduccion=document.querySelector("#eliminarFilaActividadesProduccion"),botonEliminarFilaOtosCostos=document.querySelector("#eliminarFilaOtosCostos");botonEliminarFilaActividadesProduccion.addEventListener("click",()=>{eliminarUltimaFila("#tablaActividadesProduccion",colecta.actividadesProduccion,almacenarDatosActividadesProduccion)}),botonEliminarFilaOtosCostos.addEventListener("click",()=>{eliminarUltimaFila("#tablaOtrosCostos",colecta.otrosCostos,almacenarDatosOtrosCostos)});const botonNuevaFilaContrucciones=document.querySelector("#nuevaFilaContrucciones"),botonNuevaFilaVehiculos=document.querySelector("#nuevaFilaVehiculos"),botonNuevaFilaImplementos=document.querySelector("#nuevaFilaImplementos"),botonNuevaFilaEquipoComunicacion=document.querySelector("#nuevaFilaEquipoComunicacion"),botonNuevaFilaEquipo=document.querySelector("#nuevaFilaEquipo");function filaOtrosActivosFijos(e,t){const o=document.querySelector(e).children[1],a=document.createElement("TR"),l=document.createElement("TD"),r=document.createElement("TD"),n=document.createElement("TD"),c=document.createElement("TD"),i=document.createElement("TD");i.classList.add("etiqueta","porcentaje");const s=document.createElement("TD");s.classList.add("etiqueta");const u=document.createElement("TD");u.classList.add("etiqueta");const d=document.createElement("TD");d.classList.add("valorDepreciacionAnual");const m=document.createElement("INPUT"),p=document.createElement("INPUT"),b=document.createElement("INPUT"),C=document.createElement("INPUT"),v=document.createElement("INPUT"),A=document.createElement("INPUT"),h=document.createElement("INPUT");m.setAttribute("type","text"),m.setAttribute("placeholder","Escribe el nombre"),m.setAttribute("required",""),p.setAttribute("type","number"),p.setAttribute("placeholder","Ej. 2012"),b.setAttribute("type","number"),b.setAttribute("required",""),"#tablaContrucciones"!==e&&b.setAttribute("placeholder","Ej. 2012"),C.setAttribute("type","number"),C.setAttribute("required",""),C.value=0,v.setAttribute("type","number"),v.value=0,"#tablaContrucciones"===e&&v.setAttribute("disabled",""),A.setAttribute("type","number"),A.classList.add("valorActualMercado"),A.value=0,h.setAttribute("type","number"),h.classList.add("valorRecuperacion"),h.value=0;const q=document.createElement("SPAN");q.innerHTML="<span>%</span>",l.appendChild(m),r.appendChild(p),n.appendChild(b),c.appendChild(C),i.appendChild(v),i.appendChild(q),s.innerHTML+="<span>$</span>",s.appendChild(A),u.innerHTML+="<span>$</span>",u.appendChild(h),a.appendChild(l),a.appendChild(r),a.appendChild(n),a.appendChild(c),a.appendChild(i),a.appendChild(s),a.appendChild(u),a.appendChild(d),o.appendChild(a),t(),calcularOperacionesActivosFijos(e)}botonNuevaFilaContrucciones.addEventListener("click",()=>{filaOtrosActivosFijos("#tablaContrucciones",almacenarDatosConstrucciones)}),botonNuevaFilaVehiculos.addEventListener("click",()=>{filaOtrosActivosFijos("#tablaVehiculos",almacenarDatosVehiculos)}),botonNuevaFilaImplementos.addEventListener("click",()=>{filaOtrosActivosFijos("#tablaImplementos",almacenarDatosImplementos)}),botonNuevaFilaEquipoComunicacion.addEventListener("click",()=>{filaOtrosActivosFijos("#tablaEquiposComunicacion",almacenarDatosEquipoComunicacion)}),botonNuevaFilaEquipo.addEventListener("click",()=>{filaOtrosActivosFijos("#tablaEquipos",almacenarDatosEquipo)});const botonEliminarFilaConstruccion=document.querySelector("#eliminarFilaContrucciones"),botonEliminarFilaVehiculos=document.querySelector("#eliminarFilaVehiculos"),botonEliminarFilaImplementos=document.querySelector("#eliminarFilaImplementos"),botonEliminarFilaEquipoComunicacion=document.querySelector("#eliminarFilaEquipoComunicacion"),botonEliminarFilaEquipo=document.querySelector("#eliminarFilaEquipo");function eliminarUltimaFila(e,t,o=null,a=null){const l=document.querySelector(e).children[1],r=l.rows.length-1,n=l.children[r];l.children.length>1&&(n.remove(),t.pop()),o&&o(),a&&a(e)}botonEliminarFilaConstruccion.addEventListener("click",()=>{eliminarUltimaFila("#tablaContrucciones",colecta.construcciones,funcion=null,operacionesOtrosActivosFijos)}),botonEliminarFilaVehiculos.addEventListener("click",()=>{eliminarUltimaFila("#tablaVehiculos",colecta.vehiculos,funcion=null,operacionesOtrosActivosFijos)}),botonEliminarFilaImplementos.addEventListener("click",()=>{eliminarUltimaFila("#tablaImplementos",colecta.implementos,funcion=null,operacionesOtrosActivosFijos)}),botonEliminarFilaEquipoComunicacion.addEventListener("click",()=>{eliminarUltimaFila("#tablaEquipoComunicacion",colecta.equiposComunicacion,funcion=null,operacionesOtrosActivosFijos)}),botonEliminarFilaEquipo.addEventListener("click",()=>{eliminarUltimaFila("#tablaEquipos",colecta.equipos,funcion=null,operacionesOtrosActivosFijos)});const botonNuevaFilaCostoAnualEstablecimientoPlantacion=document.querySelector("#nuevaFilaCostoAnualEstablecimientoPlantacion");function filaCostoAnualEstablecimientoPlantacion(e,t){const o=document.querySelector(e).children[1],a=document.createElement("TR"),l=document.createElement("TD"),r=document.createElement("TD"),n=document.createElement("INPUT"),c=document.createElement("INPUT");r.classList.add("etiqueta"),n.setAttribute("type","text"),n.setAttribute("required",""),c.setAttribute("type","number"),c.classList.add("costoAnual"),l.appendChild(n),r.innerHTML+="<span>$</span>",r.appendChild(c),a.appendChild(l),a.appendChild(r),o.appendChild(a),t(),colocarNumeroAnio(),operacionesValorPlantacion(),colectaCostoAnualEstablecimientoPlantacion()}botonNuevaFilaCostoAnualEstablecimientoPlantacion.addEventListener("click",()=>{filaCostoAnualEstablecimientoPlantacion("#tablaCostoAnualEstablecimientoPlantacion",almacenarDatosCostoAnualEstablecimientoPlantacion)});const botonEliminarFilaCostoAnualEstablecimientoPlantacion=document.querySelector("#eliminarFilaCostoAnualEstablecimientoPlantacion");botonEliminarFilaCostoAnualEstablecimientoPlantacion.addEventListener("click",()=>{eliminarUltimaFila("#tablaCostoAnualEstablecimientoPlantacion",colecta.costoAnualesEstablecimientoPlantacion,almacenarDatosCostoAnualEstablecimientoPlantacion,operacionesValorPlantacion)});const formatter=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});function extraerCaracteresNumber(e){let t=e.replaceAll(",","").replaceAll("$","");return parseFloat(t)}function convertirValorMonetario(e){return formatter.format(e)}